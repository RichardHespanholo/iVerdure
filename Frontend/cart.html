<!DOCTYPE html>
<html lang="en">

<head>
	<title>Pedidos</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="images/icons/favicon.png" />
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/themify/themify-icons.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/elegant-font/html-css/style.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<!--===============================================================================================-->
</head>

<body class="animsition">

	<!-- Header -->
	<header class="header1">
		<!-- Header desktop -->
		<div class="container-menu-header">
			<div class="topbar">
				<div class="topbar-social">
					<a href="#" class="topbar-social-item fa fa-facebook"></a>
					<a href="#" class="topbar-social-item fa fa-instagram"></a>
					<a href="#" class="topbar-social-item fa fa-pinterest-p"></a>
					<a href="#" class="topbar-social-item fa fa-snapchat-ghost"></a>
					<a href="#" class="topbar-social-item fa fa-youtube-play"></a>
				</div>

				<div class="topbar-child2">

				</div>
			</div>

			<div class="wrap_header">
				<!-- Logo -->
				<a href="index.html" class="logo">
						<a href="index.html" class="logo">
								<h4 style="color:#000">Iverdure</h4>
							</a>
							<div class="wrap_menu">
								<nav class="menu">
									<ul class="main_menu">
										<li>
											<a href="index.html">Home</a>
										</li>

										<li>
											<a href="product.html">Produtos</a>
										</li>

										<li>
											<a href="about.html">Sobre</a>
										</li>
									</ul>
								</nav>
							</div>

							<!-- Header Icon -->
							<div class="header-icons">
								<a href="pedidos.html" class="header-wrapicon1 dis-block">
									<img src="images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
								</a>
								<span class="linedivide2"></span>
								<a id="nomeuser" href="pedidos.html"></a>

	
							</div>
			</div>
		</div>

		<!-- Header Mobile -->
		<div class="wrap_header_mobile">
			<!-- Logo moblie -->
			<a href="index.html" class="logo-mobile">
				<img src="images/icons/logo.png" alt="IMG-LOGO">
			</a>

			<!-- Button show menu -->
			<div class="btn-show-menu">
				<!-- Header Icon mobile -->
				<div class="header-icons-mobile">
					<a href="pedidos.html" class="header-wrapicon1 dis-block">
						<img src="images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					</a>
					<span class="linedivide2"></span>
					<a id="nomeuser" href="pedidos.html"></a>

				</a>
				</div>

				<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
					<span class="hamburger-box">
						<span class="hamburger-inner"></span>
					</span>
				</div>
			</div>
		</div>

		<!-- Menu Mobile -->
		<div class="wrap-side-menu">
			<nav class="side-menu">
				<ul class="main-menu">

					<li class="item-topbar-mobile p-l-20 p-t-8 p-b-8">
						<div class="topbar-child2-mobile">
							<span class="topbar-email">
								Tafarel Costa Machado
							</span>
						</div>
					</li>

					<li class="item-topbar-mobile p-l-10">
						<div class="topbar-social-mobile">
							<a href="#" class="topbar-social-item fa fa-facebook"></a>
							<a href="#" class="topbar-social-item fa fa-instagram"></a>
							<a href="#" class="topbar-social-item fa fa-pinterest-p"></a>
							<a href="#" class="topbar-social-item fa fa-snapchat-ghost"></a>
							<a href="#" class="topbar-social-item fa fa-youtube-play"></a>
						</div>
					</li>

					<li class="item-menu-mobile">
						<a href="index.html">Home</a>
						<i class="arrow-main-menu fa fa-angle-right" aria-hidden="true"></i>
					</li>

					<li class="item-menu-mobile">
						<a href="product.html">Produtos</a>
					</li>

					<li class="item-menu-mobile">
						<a href="about.html">Sobre</a>
					</li>

					<li class="item-menu-mobile">
						<a href="contact.html">Contato</a>
					</li>
				</ul>
			</nav>
		</div>
	</header>

	<!-- Title Page -->
	<section class="bg-title-page p-t-50 p-b-40 flex-col-c-m" style="background-color: #828282">
		<h2 class="l-text2 t-center">
			CARRINHO
		</h2>
	</section>

	<!-- Cart -->
	<section class="cart bgwhite p-t-70 p-b-100">
		<div class="container">
			<div class="row">
				<!-- Cart item -->
				<div class="container-table-cart pos-relative">
					<div class="wrap-table-shopping-cart bgwhite">
						<div id="produto"></div>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6 p-b-30">
					<form class="leave-comment">
						<h4 class="m-text26 p-b-36 p-t-15">
							Entrega
						</h4>

						<div class="bo4 of-hidden size15 m-b-20">
							<input class="sizefull s-text7 p-l-22 p-r-22" type="date" id="data" name="data-entrega" placeholder="Data Entrega">
						</div>
					</form>
				</div>
				<div class="bo9 w-size18 p-l-40 p-r-40 p-t-30 p-b-38 m-t-30 m-r-0 m-l-auto p-lr-15-sm">
					<h5 class="m-text20 p-b-24">
						Totais do Carrinho
					</h5>

					<div class="flex-w flex-sb-m p-b-12">
						<span class="s-text18 w-size19 w-full-sm">
							Subtotal:
						</span>
						<span class="m-text21 w-size20 w-full-sm" id="subtotal">

						</span>
					</div>
					<div class="flex-w flex-sb bo10 p-t-15 p-b-20">
						<span class="s-text18 w-size19 w-full-sm">
							Entrega:
						</span>
						<span class="m-text21 w-size20 w-full-sm">
							R$6.00
						</span>
					</div>
					<div class="flex-w flex-sb-m p-t-26 p-b-30">
						<span class="m-text22 w-size19 w-full-sm">
							Total:
						</span>

						<span class="m-text21 w-size20 w-full-sm" id="total">
							
						</span>
					</div>

					<div class="size15 trans-0-4">

						<button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4" onclick="finalizarPedido()">
							Fechar Pedido
						</button>
					</div>
				</div>
			</div>

		</div>
	</section>

	<!-- Footer -->
	<!-- Footer -->
	<footer class="bg6 p-t-45 p-b-43 p-l-65 p-r-65 p-lr-0-xl1">
		<div class="container">
			<div class="flex-w p-b-90">
				<div class="w-size6 p-t-30 p-l-15 p-r-15 respon6">
					<h4 class="s-text12 p-b-30">
						Entrar em Contato
					</h4>

					<div>
						<p class="s-text7 w-size26">
							Alameda jose de oliveira dos bosques Numero:468 Bairro Jardim Patricia (034) 98749-978754
						</p>

						<div class="flex-m p-t-30">
							<a href="#" class="fs-18 color1 p-r-20 fa fa-facebook"></a>
							<a href="#" class="fs-18 color1 p-r-20 fa fa-instagram"></a>
							<a href="#" class="fs-18 color1 p-r-20 fa fa-pinterest-p"></a>
							<a href="#" class="fs-18 color1 p-r-20 fa fa-snapchat-ghost"></a>
							<a href="#" class="fs-18 color1 p-r-20 fa fa-youtube-play"></a>
						</div>
					</div>
				</div>


				<div class="w-size7 p-t-30 p-l-15 p-r-15 respon7">
					<h4 class="s-text12 p-b-30">
						Links
					</h4>

					<ul>
						<li class="p-b-9">
							<a href="#" class="s-text7">
								Home
							</a>
						</li>

						<li class="p-b-9">
							<a href="#" class="s-text7">
								Sobre
							</a>
						</li>

						<li class="p-b-9">
							<a href="#" class="s-text7">
								Contato
							</a>
						</li>
					</ul>
				</div>

				<div class="w-size7 p-t-30 p-l-15 p-r-15 respon7">
					<h4 class="s-text12 p-b-30">
						Ajuda
					</h4>

					<ul>
						<li class="p-b-9">
							<a href="#" class="s-text7">
								Acompanhar Pedidos
							</a>
						</li>
					</ul>
				</div>

			</div>

			<div class="t-center p-l-15 p-r-15">
				<!--
			<a href="#">
				<img class="h-size2" src="images/icons/paypal.png" alt="IMG-PAYPAL">
			</a>

			<a href="#">
				<img class="h-size2" src="images/icons/visa.png" alt="IMG-VISA">
			</a>

			<a href="#">
				<img class="h-size2" src="images/icons/mastercard.png" alt="IMG-MASTERCARD">
			</a>

			<a href="#">
				<img class="h-size2" src="images/icons/express.png" alt="IMG-EXPRESS">
			</a>

			<a href="#">
				<img class="h-size2" src="images/icons/discover.png" alt="IMG-DISCOVER">
			</a>
-->
				<div class="t-center s-text8 p-t-20">
					Copyright © 2018 All rights reserved.
				</div>
			</div>
		</div>
	</footer>






	<!-- Back to top -->
	<div class="btn-back-to-top bg0-hov" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="fa fa-angle-double-up" aria-hidden="true"></i>
		</span>
	</div>

	<!-- Container Selection -->
	<div id="dropDownSelect1"></div>
	<div id="dropDownSelect2"></div>



	<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/jquery/jquery-3.2.1.min.js"></script>
	<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/animsition/js/animsition.min.js"></script>
	<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/bootstrap/js/popper.js"></script>
	<script type="text/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
	<!--===============================================================================================-->
	<script type="text/javascript" src="vendor/select2/select2.min.js"></script>
	<script type="text/javascript">
		$(".selection-1").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect1')
		});

		$(".selection-2").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect2')
		});

	</script>

	<script type="text/javascript">

		var c = JSON.parse(sessionStorage.getItem("login"));
		console.info(c);
		if(!c){
			document.getElementById('nomeuser').innerHTML = '';
		}else{
			document.getElementById('nomeuser').innerHTML = c.nome;
		}



		var car = JSON.parse(sessionStorage.getItem("carrinho"));
		//console.info(car);
		var inicio = '<div class="container-table-cart pos-relative"><div class="wrap-table-shopping-cart bgwhite">' +
			'<table class="table-shopping-cart"><tr class="table-head"><th class="column-1"></th><th class="column-2">Produto</th>' +
			'<th class="column-3">Preço</th><th class="column-4">Loja</th><th class="column-5 p-l-70">Qtd</th><th class="column-6">Total</th></tr>';
		var mais = '';
		if (!car) {
			document.getElementById('subtotal').innerHTML = '';
		} else {
			var i = 0;
			var total = 0;
			var recebe = '';
			while (car[i]) {
				total = total + (car[i].preco * car[i].qtd);
				mais = mais + '<tr class="table-row">' +
					'<td class="column-1">' +
					'<div class="cart-img-product b-rad-4 o-f-hidden">' +
					'<img src="images/item-10.jpg" alt="IMG-PRODUCT">' +
					'</div>' +
					'</td>' +
					'<td class="column-2">' + car[i].nome + '</td>' +
					'<td class="column-3">R$' + car[i].preco + '</td>' +
					'<td  class="column-4"><a href="#">' + car[i].nomeFantasia + '</a></td>' +
					'<td class="column-5">' +
					'<div class="flex-w bo5 of-hidden w-size17">' +
					'<button class="btn-num-product-down color1 flex-c-m size7 bg8 eff2">' +
					'<i class="fs-12 fa fa-minus" aria-hidden="true"></i>' +
					'</button>' +

					'<input class="size8 m-text18 t-center num-product" type="number" name="num-product1" value="' + car[i].qtd + '">' +

					'<button class="btn-num-product-up color1 flex-c-m size7 bg8 eff2">' +
					'<i class="fs-12 fa fa-plus" aria-hidden="true"></i>' +
					'</button>' +
					'</div>' +
					'</td>' +
					'<td class="column-6">R$' + car[i].preco * car[i].qtd + '</td>' +
					'</tr>';
				i++;
			}
			var fim = '</table>' +
				'</div>' +
				'</div>' +
				'</div>';
			var tudo = inicio + mais + fim;
			document.getElementById('produto').innerHTML = tudo;
			document.getElementById('subtotal').innerHTML = "R$" + total;
			document.getElementById('total').innerHTML = "R$" + (total+6);
		}
		var endereco = null;
		fetch('http://localhost:8080/v1/usuario/consultaDados?cpf=' + c.cpf, {
			method: "GET"
		})
			.then((resposta) => {
				//console.log(resposta);
				return resposta.json();
			}).then((res) => {
				endereco = res.endereco;
				//console.log(endereco);

			});

		function finalizarPedido() {
			var dataentrega = document.getElementById('data').value;

			if (!dataentrega) {
				dataentrega = new Date().getDate() + '/' + new Date().getMonth() + '/' + new Date().getFullYear();
			}



			var pedido = {
				"dataPedido": new Date().getDate() + '/' + new Date().getMonth() + '/' + new Date().getFullYear(),
				"dataEntrega": dataentrega,
				"valorTotal": total,
				"valorEntrega": 6,
				"produtos": car,
				"cpfUsuario": c.cpf,
				"nomeCliente": c.nome,
				"endereco": endereco
			};
			console.log(pedido);

			fetch('http://localhost:8080/v1/pedido/cadastrar', {
				method: "POST",
				headers: {
					'Accept': 'application/json',
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(pedido)
			})
				.then((resposta) => {
					console.log(resposta);
					if(resposta.ok){
						alert("Pedido feito");
						window.location.href = "product.html";
					}else{
						alert("Erro ao cadastrar pedido");
					}
					return resposta.json();
				})
				.then((res) => {
					console.log("aqui não");
					console.log(res);
				})
		}









	</script>
	<!--===============================================================================================-->
	<script src="js/main.js"></script>

</body>

</html>